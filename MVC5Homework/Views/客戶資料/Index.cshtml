@model IEnumerable<MVC5Homework.Models.客戶資料>

@{
    ViewBag.Title = "Index";
}

<h2>客戶資料管理</h2>
@if (TempData["ErrMsg"] != null)
{
    <script>
        alert('@TempData["ErrMsg"]');
    </script>
}
<table>
    <tr>
        <td style="vertical-align:middle">
            @Html.ActionLink("Create New", "Create") |
        </td>
        <td>
            @using (Html.BeginForm())
            {
                <table>
                    <tr>
                        <td>
                            @Html.DropDownList("類別Id", null, "全部", new { @class = "form-control", onChange= "CategorySelect();" })
                        </td>
                        <td>
                            @Html.TextBox("keyword", null, htmlAttributes: new { @class = "form-control" })
                        </td>
                        <td>
                            <input type="submit" value="搜尋" class="btn btn-default"/>
                        </td>
                        <td>
                            | <input type="submit" value="匯出Excxel" class="btn btn-default" formaction="@Url.Action("ExportExcel") "  />
                            @Html.Hidden("currentKeyword", TempData["keyword"])
                            @Html.Hidden("categoryID", TempData["Category"])
                          
                        </td>
                    </tr>
                </table>
            }
        </td>
        <td>
           
            
        </td>
    </tr>
</table>
   
<table class="table">
    <tr>
        <th>
            @Html.ActionLink("客戶名稱", "Index", new { sort = ViewBag.sort, id = "客戶名稱" })
        </th>
        <th>
            @Html.ActionLink("類別", "Index", new { sort = ViewBag.sort, id = "類別" })
        </th>
        <th>
            @Html.ActionLink("統一編號", "Index", new { sort = ViewBag.sort, id = "統一編號" })
        </th>
        <th>
            @Html.ActionLink("電話", "Index", new { sort = ViewBag.sort, id = "電話" })
        </th>
        <th>
            @Html.ActionLink("傳真", "Index", new { sort = ViewBag.sort, id = "傳真" })
        </th>
        <th>
            @Html.ActionLink("地址", "Index", new { sort = ViewBag.sort, id = "地址" })
        </th>
        <th>
            @Html.ActionLink("Email", "Index", new { sort = ViewBag.sort, id = "Email" })
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.客戶名稱)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.客戶分類.類別)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.統一編號)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.電話)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.傳真)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.地址)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Email)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.Id }) |
            @Html.ActionLink("Details", "Details", new { id=item.Id }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.Id })
        </td>
    </tr>
}

</table>

@section scripts{ 
    <script>
        function CategorySelect()
        {
            $("form").submit();
        }
    </script>
}